- if @incomplete_datafiles.any? && (can? :update, @dataset)
  .announcement-box
    Incomplete file uploads found, please
    =link_to("contact", "/contact")
    the Research Data Service for help if this is unexpected.
  - @incomplete_datafiles.each do |datafile|
    .row(class="#{datafile.upload_complete? ? 'uploadComplete' : 'completion-warning' }")
      %span.col-md-6
        = datafile.bytestream_name
      %span.col-md-3
        = datafile.bytestream? ? "exists in storage" : "incomplete--edit dataset to manage"
      - if datafile.bytestream?
        .col-md-2
          = number_to_human_size(datafile.bytestream_size)
        .col-md-2
          %a.btn.btn-primary.btn-block.idb{href: "#{IDB_CONFIG[:root_url_text]}/datafiles/#{datafile.web_id}/download_no_record", "aria-label": "download #{datafile.bytestream_name}" }
            %span{class: "glyphicon glyphicon-download"}
            File
- elsif can? :update, @dataset
  .announcement-box
    No incomplete file uploads found.
- elsif @dataset.metadata_public?
  .announcement-box
    Not authorized for this view.
  = render 'brief_record', dataset:@dataset
- else
  = render 'metadata_restriction_alert', dataset: @dataset